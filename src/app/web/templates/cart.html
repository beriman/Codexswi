{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6">Keranjang Belanja</h1>

    {% if cart.items %}
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="space-y-4">
            {% for item in cart.items %}
            <div class="flex items-center justify-between border-b pb-4">
                <div class="flex-1">
                    <h3 class="font-semibold">{{ item.product_name }}</h3>
                    <p class="text-sm text-gray-600">{{ item.brand_name }}</p>
                    <p class="text-sm text-gray-800">Rp {{ "{:,.0f}".format(item.unit_price) }}</p>
                </div>
                <div class="flex items-center space-x-4">
                    <form action="/api/cart/update" method="post" class="flex items-center">
                        <input type="hidden" name="product_id" value="{{ item.product_id }}">
                        <input 
                            type="number" 
                            name="quantity" 
                            value="{{ item.quantity }}" 
                            min="1" 
                            class="w-16 px-2 py-1 border rounded"
                            onchange="this.form.submit()"
                        >
                    </form>
                    <p class="font-semibold">Rp {{ "{:,.0f}".format(item.unit_price * item.quantity) }}</p>
                    <form action="/api/cart/remove" method="post">
                        <input type="hidden" name="product_id" value="{{ item.product_id }}">
                        <button type="submit" class="text-red-600 hover:text-red-800">
                            Hapus
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="mt-6 pt-6 border-t">
            <div class="flex justify-between text-lg font-semibold mb-4">
                <span>Subtotal:</span>
                <span>Rp {{ "{:,.0f}".format(cart.subtotal) }}</span>
            </div>
            <div class="flex justify-between text-sm text-gray-600 mb-2">
                <span>Ongkos Kirim:</span>
                <span>Akan dihitung di checkout</span>
            </div>
            <div class="flex justify-between text-xl font-bold mb-6">
                <span>Total:</span>
                <span>Rp {{ "{:,.0f}".format(cart.total) }}</span>
            </div>
            <div class="flex space-x-4">
                <a href="/marketplace" class="flex-1 text-center bg-gray-200 text-gray-800 px-6 py-3 rounded-lg hover:bg-gray-300">
                    Lanjut Belanja
                </a>
                <a href="/checkout" class="flex-1 text-center bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                    Checkout
                </a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="bg-white rounded-lg shadow-md p-12 text-center">
        <p class="text-gray-600 text-lg mb-6">Keranjang belanja Anda kosong</p>
        <a href="/marketplace" class="inline-block bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700">
            Mulai Belanja
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
